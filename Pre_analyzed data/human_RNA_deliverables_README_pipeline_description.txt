Brief summary of the standard human RNA-Seq pipeline:

rRNA abundance was measured by mapping with Bowtie2.

Quality control was performed using Picard and RSeQC.

The reads were aligned with STAR (version 2.5.2a), and annotated genes were quantified with featureCounts (v1.4.3-p1). Normalization and differential expression was done with the Bioconductor package DESeq2 (v1.18.1).

Genome using only canonical chromosomes (chr1-22, X, Y, and M) was used to align.

If alignment was performed vs. GRCh37 genome, Gencode v18 annotation was used. If alignment was performed vs. GRCh38 genome, Gencode v25 annotation was used.

For somatic samples, FusionCatcher (v0.99.7b) and STAR-Fusion (v1.0.0) are used to detect fusions.

Feel free to ask us for more details. For STAR and featureCounts, the exact command lines are listed in the header of the files, accessible with:

*samtools view -H Sample*.final.bam

and

*head -l Sample_counts.txt

----

*Deliverables

The deliverables files correspond to "sample-level" files and "project-level" files (in a Results, or Results_date folder).

Sample-level files include:

X.final.bam - Alignment generated by STAR aligner. Properly formatted (i.e. sorted by coordinate) for post-processing and visualization in IGV.
X.final.bai - BAM index. Necessary for viewing in IGV.
X.final.sj.out.tab - Splice junction file output by STAR aligner. Columns are outlined here (descriptions from STAR manual):

Column 1: chromosome
Column 2: first base of the intron (1-based)
Column 3: last base of the intron (1-based)
Column 4: strand (0: undefined, 1: +, 2: -)
Column 5: intron motif: 0: non-canonical, 1: GT/AG, 2: CT/AC, 3: GC/AG, 4: CT/GC, 5: AT/AC, 6: GT/AT
Column 6: 0: unannotated, 1: annotated
Column 7: number of uniquely mapping reads crossing the junction
Column 8: number of multi-mapping reads crossing the junction
Column 9: maximum spliced alignment overhang

X.sj2psi.csv - "Percentage Spliced In" values for exon exon-intron junction. Derived from the SJ.out.tab file by the script SJ2PSI.

Gene expression:

X.counts.txt - Output of featureCounts for this sample. The columns correspond to gene ID (in ENSEMBL), coordinates, strand, length of the transcript and counts (=number of reads mapping to the exons of the gene). To obtain RPKM, divide the counts by the length of the transcript (in kb) times the total number of reads mapping to genes in the sample (and multiply by 1e6).

X.counts.txt.summary - Another sample-level output of featureCounts. Gives information about the proportion of reads that could be assigned to genes versus reads that could not be assigned because they were not in exons or overlapped multiple genes or were not uniquely mapped.

Transcript expression:

kallisto/abundance.tsv - Output of Kallisto (isoform-level quantification program) for this sample.

kallisto/run_info.json - Another output of Kallisto for this sample, giving the command line used in a text file.

FusionCatcher (somatic samples only):

fusioncatcher/final-list_candidate-fusion-genes.txt - Main output of fusion detection program FusionCatcher. See manual for more details on each column.

final-list_candidate-fusion-genes.GRCh37.txt - Main output of FusionCatcher gives breakpoints in GRCh38 coordinates. Use this file for GRCh37 coordinates of the breakpoints.

fusioncatcher/info.txt - Output by FusionCatcher detailing parameter/version info for the FusionCatcher run.

fusioncatcher/summary_candidate_fusions.txt - Output by FusionCatcher summarizing the fusions found, including likely false positives and whether fusions are known or novel.

fusioncatcher/supporting-reads_gene-fusions*zip - Unzip to get a FASTA/FASTQ file for each fusion found by the corresponding method.

fusioncatcher/viruses_bacteria_phages.txt - Count of mapping reads per different viruses/bacteria/phages detected by FusionCatcher.

STAR-Fusion (somatic samples only):

starfusion/star-fusion.fusion_candidates.final - Main final output of fusion detection program STAR-Fusion. See manual for more details on each column.
starfusion/star-fusion.fusion_candidates.final.abridged - Same as starfusion/star-fusion.fusion_candidates.final, except less wide because excludes columns JunctionReads and SpanningFrags that give the names of reads supporting the fusion.

Project-level files:

DESeq2_results_A_vs_B.csv - If differential expression was run, the results would be in this table.

Gene - Ensembl gene ID.
baseMean - Mean normalized expression across samples in both groups. You may find it useful to filter out genes with a very low value in this column.
log2FoldChange - log2(A/B), where which group is the numerator vs. denominator is given by the file name.
pvalue - Unadjusted p-value. You won't want to use this directly, though it may be useful for downstream programs such as GSEA.
padj - Adjusted p-value. This is the column you want to use to determine which genes are significantly DE.

After this, the file also will include a number of information columns about the genes, such as whether they are coding or noncoding and the gene symbol corresponding to the Ensembl ID.

DESEq2_normalized_count_matrix.txt - Count matrix for counts per gene, normalized for library size using DESeq2.
DESeq2_regularized_log_transformed.txt - Made using the rlogTransformation function in DESeq2. This function transforms the count data to the log2 scale in a way which minimizes differences between samples for rows with small counts, and which normalizes with respect to library size. These are the values used to obtain clustering and PCA results.

For large sample sizes, varianceStabilizingTransformation may have been used instead.

QC_statistics_to_deliver.txt:

Tot_reads(M)- Total number of reads in the sample, in millions
rRNA(%)- Percent of reads aligned to ribosomal RNA
Map(%)- Percent of reads which map to genome
UQ_map(%)- Percent of reads which map to only one locus on the genome
Gene_assn(%)- Of uniquely mapped reads, percentage which may be assigned to exons of genes by gene counting program featureCounts.
Strand(%)- Percentage of reads which are reversely stranded.
5prime_cov- Mean normalized coverage from Picard for percentiles 11-30 along gene body
3prime_cov- Mean normalized coverage from Picard for percentiles 71-90 along gene body
Mean_GC(%)- Mean GC content averaging GC content for each read across all reads
Dup(%)- Percentage of reads which were duplicates
Mean_inner_dist- Inner distance = Read 2 start - Read 1 end. Negative indicates overlap.
CDS, UTR, Intronic, and Intergenic(%)- Percentage of reads assigned to different regions of the genome. These four add up to 100%.
chrM(%)- For reads assigned to genes, percentage assigned to mitochondrial genes.
Top_ten(%)- For reads assigned to genes, percentage assigned to the top 10 most highly expressed genes.
Splice_rate(%) - Number of total splices as output by the STAR aligner, divided by the total number of reads.

QC_plots.pdf:

Page 1 and 2 - Gene body coverage
Page 3 and 4 - GC Content
Page 5 and 6 - Inner distance
Page 7 - Cumulative curve (% of reads mapping to gene corresponding to the most highly expressed gene, to the top 10, top 100, top 1000 most highly expressed genes)
Page 8 and 9 - Barplots corresponding to columns "Map(%) and UQ_map(%)" and "CDS, UTR, Intronic, and Intergenic (%)" in the table QC_statistics_to_deliver.txt.
Page 10 - Xist vs. chrY. In order to spot gender mix-up, we plot the expression of the female-specific lincRNA Xist versus the cumulative expression of protein-coding genes on chromosome Y.
Page 11 and 12 - Hierarchical clustering of the expression profiles.
Page 13 and 14 - Principal component analysis (PC1 and PC2) and multi-dimensional scaling plot of the expression profiles.

*featureCounts_count_matrix.txt

Raw count matrix with counts per gene as obtained by featureCounts

*TPM_from_featureCounts.txt

Counts per gene normalized both for gene length and library size using the TPM formula. In the TPM formula, counts are first normalized for gene length in kb. Then, the sum of these length-normalized values divided by 1e6 is used to normalize for library size.
